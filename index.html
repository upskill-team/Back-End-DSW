<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>back-end-dsw - v1.0.0</title><meta name="description" content="Documentation for back-end-dsw"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">back-end-dsw - v1.0.0</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>back-end-dsw - v1.0.0</h1></div><div class="tsd-panel tsd-typography"><h1 id="back-end-dsw" class="tsd-anchor-link">Back-End-DSW<a href="#back-end-dsw" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><h2 id="-gesti贸n-de-migraciones-de-base-de-datos" class="tsd-anchor-link"> Gesti贸n de Migraciones de Base de Datos<a href="#-gesti贸n-de-migraciones-de-base-de-datos" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Este documento describe el flujo de trabajo para gestionar los cambios en el esquema de la base de datos utilizando el sistema de migraciones de MikroORM.</p>
<h2 id="filosof铆a" class="tsd-anchor-link">Filosof铆a<a href="#filosof铆a" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Este proyecto utiliza un sistema de migraciones versionado para gestionar todos los cambios en el esquema de la base de datos. Este sistema reemplaza el m茅todo anterior e inseguro de usar <code>syncSchema()</code>, que no es adecuado para entornos de producci贸n ya que puede provocar la p茅rdida de datos.</p>
<p>Las migraciones nos permiten:</p>
<ul>
<li><strong>Versionar los Cambios:</strong> Cada cambio en el esquema (a帽adir una tabla, una columna, un 铆ndice, etc.) se representa en un archivo de migraci贸n, que se versiona en Git como cualquier otro c贸digo.</li>
<li><strong>Prevenir la P茅rdida de Datos:</strong> Las migraciones se aplican de forma controlada, asegurando que los cambios se realicen de manera predecible.</li>
<li><strong>Colaboraci贸n en Equipo:</strong> Permite que m煤ltiples desarrolladores trabajen en cambios de la base de datos de forma segura y sin conflictos.</li>
<li><strong>Despliegues Confiables:</strong> El estado de la base de datos en producci贸n siempre est谩 sincronizado con el c贸digo de la aplicaci贸n.</li>
</ul>
<h2 id="el-nuevo-flujo-de-trabajo" class="tsd-anchor-link">El Nuevo Flujo de Trabajo<a href="#el-nuevo-flujo-de-trabajo" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Cuando necesites realizar un cambio en la estructura de la base de datos (por ejemplo, a帽adir una nueva propiedad a una entidad), sigue estos pasos:</p>
<h3 id="paso-1-modificar-una-entidad" class="tsd-anchor-link">Paso 1: Modificar una Entidad<a href="#paso-1-modificar-una-entidad" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Realiza los cambios necesarios en tu archivo de entidad. Por ejemplo, para a帽adir un campo <code>middleName</code> a la entidad <code>User</code>:</p>
<pre><code class="typescript"><span class="hl-0">// src/models/user/user.entity.ts</span><br/><span class="hl-0">// ...</span><br/><span class="hl-1">export</span><span class="hl-2"> </span><span class="hl-3">class</span><span class="hl-2"> </span><span class="hl-4">User</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-0">// ... (propiedades existentes)</span><br/><br/><span class="hl-2">  @</span><span class="hl-5">Property</span><span class="hl-2">({ </span><span class="hl-6">nullable:</span><span class="hl-2"> </span><span class="hl-3">true</span><span class="hl-2"> })</span><br/><span class="hl-2">  </span><span class="hl-6">middleName</span><span class="hl-2">?: </span><span class="hl-4">string</span><span class="hl-2">; </span><span class="hl-0">// &lt;-- Nuevo campo</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="paso-2-generar-la-migraci贸n" class="tsd-anchor-link">Paso 2: Generar la Migraci贸n<a href="#paso-2-generar-la-migraci贸n" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Una vez que hayas guardado los cambios en tu entidad, ejecuta el siguiente comando desde la ra铆z del proyecto para que MikroORM compare el estado actual de tus entidades con el estado de la 煤ltima migraci贸n y genere un nuevo archivo con las diferencias:</p>
<pre><code class="bash"><span class="hl-5">pnpm</span><span class="hl-2"> </span><span class="hl-7">migration:create</span>
</code><button type="button">Copy</button></pre>

<p><strong>Mejor Pr谩ctica (Recomendado):</strong> Para que tu historial de migraciones sea m谩s legible, dale un nombre descriptivo a tu migraci贸n usando el flag <code>-n</code>:</p>
<pre><code class="bash"><span class="hl-5">pnpm</span><span class="hl-2"> </span><span class="hl-7">migration:create</span><span class="hl-2"> </span><span class="hl-3">-n</span><span class="hl-2"> </span><span class="hl-7">AddMiddleNameToUser</span>
</code><button type="button">Copy</button></pre>

<p>Esto crear谩 un nuevo archivo en la carpeta <code>src/migrations</code> con un nombre similar a <code>Migration20240523103000_AddMiddleNameToUser.ts</code>.</p>
<h3 id="paso-3-revisar-el-archivo-de-migraci贸n-generado" class="tsd-anchor-link">Paso 3: Revisar el Archivo de Migraci贸n Generado<a href="#paso-3-revisar-el-archivo-de-migraci贸n-generado" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Abre el nuevo archivo de migraci贸n. Ver谩s dos m茅todos principales:</p>
<ul>
<li><code>up()</code>: Contiene el c贸digo que se ejecutar谩 para <strong>aplicar</strong> tus cambios (ej. <code>ALTER TABLE</code>, <code>CREATE INDEX</code>).</li>
<li><code>down()</code>: Contiene el c贸digo para <strong>revertir</strong> esos cambios.</li>
</ul>
<p>Es una buena pr谩ctica revisar r谩pidamente este archivo para asegurarte de que los cambios generados son los que esperabas.</p>
<h3 id="paso-4-aplicar-la-migraci贸n" class="tsd-anchor-link">Paso 4: Aplicar la Migraci贸n<a href="#paso-4-aplicar-la-migraci贸n" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Tienes dos maneras de aplicar la migraci贸n en tu entorno de desarrollo:</p>
<ol>
<li>
<p><strong>Autom谩ticamente (Recomendado):</strong> Simplemente inicia o reinicia el servidor de desarrollo. La aplicaci贸n est谩 configurada para ejecutar autom谩ticamente todas las migraciones pendientes al arrancar.</p>
<pre><code class="bash"><span class="hl-5">pnpm</span><span class="hl-2"> </span><span class="hl-7">start:dev</span>
</code><button type="button">Copy</button></pre>

<p>Ver谩s un log en la consola indicando que la nueva migraci贸n se ha ejecutado.</p>
</li>
<li>
<p><strong>Manualmente:</strong> Si prefieres aplicar la migraci贸n sin reiniciar el servidor, puedes usar el comando <code>up</code>:</p>
<pre><code class="bash"><span class="hl-5">pnpm</span><span class="hl-2"> </span><span class="hl-7">migration:up</span>
</code><button type="button">Copy</button></pre>

</li>
</ol>
<p>Ya est谩, ahora tu cambio de esquema se aplic贸 de forma segura y est谩 versionado en el repositorio.</p>
<h2 id="comandos-disponibles" class="tsd-anchor-link">Comandos Disponibles<a href="#comandos-disponibles" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Resumen de los scripts de migraci贸n disponibles en <code>package.json</code>:</p>
<table>
<thead>
<tr>
<th>Comando</th>
<th>Descripci贸n</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pnpm migration:create</code></td>
<td>Genera un nuevo archivo de migraci贸n con los cambios detectados en las entidades.</td>
</tr>
<tr>
<td><code>pnpm migration:up</code></td>
<td>Aplica todas las migraciones pendientes que a煤n no se han ejecutado en la base de datos.</td>
</tr>
<tr>
<td><code>pnpm migration:down</code></td>
<td>Revierte la 煤ltima migraci贸n que fue aplicada. til para deshacer r谩pidamente un cambio durante el desarrollo.</td>
</tr>
<tr>
<td><code>pnpm migration:fresh</code></td>
<td><strong>隆PELIGROSO!</strong> Elimina toda la base de datos y vuelve a ejecutar todas las migraciones desde el principio. <strong>salo solo en desarrollo.</strong></td>
</tr>
</tbody>
</table>
<h2 id="buenas-pr谩cticas-y-consideraciones" class="tsd-anchor-link">Buenas Pr谩cticas y Consideraciones<a href="#buenas-pr谩cticas-y-consideraciones" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Las Migraciones son Inmutables:</strong> Una vez que una migraci贸n ha sido fusionada a la rama principal (<code>main</code> o <code>develop</code>), <strong>nunca debe ser editada</strong>. Si necesitas corregir algo, crea una <strong>nueva</strong> migraci贸n que aplique la correcci贸n.</li>
<li><strong>Trabajo en Equipo:</strong> Si haces <code>git pull</code> y un compa帽ero ha a帽adido una nueva migraci贸n, simplemente ejecuta <code>pnpm migration:up</code> (o reinicia tu servidor) para poner tu base de datos local al d铆a.</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-alpha" name="alpha"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Alpha</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-beta" name="beta"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Beta</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#back-end-dsw"><span>Back-<wbr/>End-<wbr/>DSW</span></a><ul><li><a href="#-gesti贸n-de-migraciones-de-base-de-datos"><span> <wbr/>Gesti贸n de <wbr/>Migraciones de <wbr/>Base de <wbr/>Datos</span></a></li><li><a href="#filosof铆a"><span>Filosof铆a</span></a></li><li><a href="#el-nuevo-flujo-de-trabajo"><span>El <wbr/>Nuevo <wbr/>Flujo de <wbr/>Trabajo</span></a></li><li><ul><li><a href="#paso-1-modificar-una-entidad"><span>Paso 1: <wbr/>Modificar una <wbr/>Entidad</span></a></li><li><a href="#paso-2-generar-la-migraci贸n"><span>Paso 2: <wbr/>Generar la <wbr/>Migraci贸n</span></a></li><li><a href="#paso-3-revisar-el-archivo-de-migraci贸n-generado"><span>Paso 3: <wbr/>Revisar el <wbr/>Archivo de <wbr/>Migraci贸n <wbr/>Generado</span></a></li><li><a href="#paso-4-aplicar-la-migraci贸n"><span>Paso 4: <wbr/>Aplicar la <wbr/>Migraci贸n</span></a></li></ul></li><li><a href="#comandos-disponibles"><span>Comandos <wbr/>Disponibles</span></a></li><li><a href="#buenas-pr谩cticas-y-consideraciones"><span>Buenas <wbr/>Pr谩cticas y <wbr/>Consideraciones</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">back-end-dsw - v1.0.0</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
