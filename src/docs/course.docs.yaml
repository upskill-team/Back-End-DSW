tags:
  - name: Courses
    description: Operations to manage courses and their content.

components:
  schemas:
    Material:
      type: object
      properties:
        title:
          type: string
          description: The title of the learning material.
          example: 'Introduction Video'
        description:
          type: string
          description: A brief description of the material.
          example: 'An introductory video explaining the basics'
        url:
          type: string
          format: uri
          description: The URL to access the material.
          example: 'https://example.com/video/intro'

    Unit:
      type: object
      properties:
        unitNumber:
          type: integer
          description: The sequential number of the unit for ordering.
          example: 1
        name:
          type: string
          description: The name or title of the unit.
          example: 'Getting Started'
        detail:
          type: string
          description: The main instructional content of the unit.
          example: 'In this unit, you will learn the fundamentals...'
        materials:
          type: array
          items:
            $ref: '#/components/schemas/Material'
          description: Learning materials associated with this unit.

    Course:
      type: object
      properties:
        id:
          type: string
          description: The unique, auto-generated ID of the course.
          example: '507f1f77bcf86cd799439011'
        name:
          type: string
          description: The public name of the course.
          example: 'Advanced Node.js Development'
        description:
          type: string
          description: A detailed description of the course content.
          example: 'Learn advanced Node.js concepts including microservices, performance optimization, and testing.'
        isFree:
          type: boolean
          description: Whether the course is free or requires payment.
          example: true
          default: true
        price:
          type: number
          nullable: true
          description: The cost of the course if isFree is false.
          example: 99.99
        units:
          type: array
          items:
            $ref: '#/components/schemas/Unit'
          description: The structured content of the course, divided into units.
        courseType:
          type: string
          description: The ID of the course type/category.
          example: '686c017c5559dcad57bc6fa6'
        professor:
          type: string
          description: The ID of the professor responsible for the course.
          example: '686c1b7e68e202f38df086c9'
        students:
          type: array
          items:
            type: string
            example: '507f191e810c19729de860ea'
          description: List of student IDs enrolled in the course.

    CreateCourseInput:
      type: object
      required:
        - name
        - description
        - courseTypeId
      properties:
        name:
          type: string
          description: The name for the new course.
          example: 'Advanced Node.js Development'
        description:
          type: string
          description: A detailed description of the course.
          example: 'Learn advanced Node.js concepts including microservices, performance optimization, and testing.'
        courseTypeId:
          type: string
          description: The ID of the course type/category.
          example: '686c017c5559dcad57bc6fa6'
        isFree:
          type: boolean
          description: Whether the course is free or requires payment.
          example: true
          default: true
        price:
          type: number
          minimum: 0
          description: The cost of the course if isFree is false.
          example: 99.99
        units:
          type: array
          items:
            $ref: '#/components/schemas/Unit'
          description: The structured content of the course, divided into units.

    UpdateCourseInput:
      type: object
      properties:
        name:
          type: string
          description: The updated name for the course.
          example: 'Advanced Node.js Development - Updated'
        description:
          type: string
          description: The updated description of the course.
          example: 'Updated comprehensive Node.js course with new content.'
        courseTypeId:
          type: string
          description: The updated course type/category ID.
          example: '686c017c5559dcad57bc6fa6'
        isFree:
          type: boolean
          description: Whether the course is free or requires payment.
          example: false
        price:
          type: number
          minimum: 0
          description: The updated cost of the course.
          example: 149.99
        units:
          type: array
          items:
            $ref: '#/components/schemas/Unit'
          description: The updated structured content of the course.

paths:
  /courses:
    get:
      summary: Get all courses
      tags: [Courses]
      description: Returns a list of all available courses.
      responses:
        '200':
          description: A list of courses was successfully retrieved.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Course'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

    post:
      summary: Create a new course (Professor Only)
      tags: [Courses]
      description: Creates a new course. Requires professor privileges.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCourseInput'
      responses:
        '201':
          description: Course created successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Course'
        '400':
          description: Validation Error. The request body is invalid.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'

  /courses/my-courses:
    get:
      summary: Get my courses (Professor Only)
      tags: [Courses]
      description: Returns a list of courses created by the authenticated professor.
      responses:
        '200':
          description: A list of the professor's courses was successfully retrieved.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Course'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'

  /courses/{id}:
    get:
      summary: Get a course by its ID
      tags: [Courses]
      description: Finds and returns a specific course using its unique ID.
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the course to retrieve.
          schema:
            type: string
      responses:
        '200':
          description: The course's data.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Course'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    put:
      summary: Update a course (Professor Only)
      tags: [Courses]
      description: Fully updates a course's data. Requires professor privileges.
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the course to update.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCourseInput'
      responses:
        '200':
          description: Course updated successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Course'
        '400':
          description: Validation Error. The request body is invalid.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    patch:
      summary: Partially update a course (Professor Only)
      tags: [Courses]
      description: Partially updates a course's data. Requires professor privileges.
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the course to update.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCourseInput'
      responses:
        '200':
          description: Course updated successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Course'
        '400':
          description: Validation Error. The request body is invalid.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    delete:
      summary: Delete a course (Professor/Admin Only)
      tags: [Courses]
      description: Permanently deletes a course from the system. Requires professor or administrator privileges.
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the course to delete.
          schema:
            type: string
      responses:
        '200':
          description: Course deleted successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Course deleted successfully'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
